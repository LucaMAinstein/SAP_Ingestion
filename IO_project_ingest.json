{"name":"IO_project_ingest","ppdf:dataflowId":"94568a1c-0225-47f4-aba9-42356c4ee472","ppdf:owner":{"tenantId":"4de83c79-9810-417a-91e1-40913a869787","userId":"c072c24c-163e-472f-a8de-a41a06a627f4"},"ppdf:fastCopy":true,"version":"1.0","culture":"en-US","modifiedTime":"2025-04-16T02:06:38.581266+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"DefaultDestination":{"queryId":"6df36e8f-f8b4-4680-81f5-53f77f2b39d9","queryName":"DefaultDestination"},"IO_Project":{"queryId":"816c0f1d-09eb-481f-b52f-eb7770ec2878","queryName":"IO_Project"},"Sample file":{"queryId":"c0ea7ae8-741a-4677-89d0-8e0190a215e8","queryName":"Sample file","queryGroupId":"cdbf1978-36dc-4cae-acdb-6b12457e0e86"},"Parameter":{"queryId":"a4c329a6-2070-4100-8113-bc2b5d401116","queryName":"Parameter","queryGroupId":"cdbf1978-36dc-4cae-acdb-6b12457e0e86"},"Transform Sample file":{"queryId":"3ec77f9a-e930-49f6-9250-251516a04307","queryName":"Transform Sample file","queryGroupId":"a35bd78c-ad74-4237-ab30-302dccd5a186"},"Transform file":{"queryId":"a52bc497-8508-4ebc-915e-526b24c18351","queryName":"Transform file","queryGroupId":"cdbf1978-36dc-4cae-acdb-6b12457e0e86"},"IO_Project_DataDestination":{"queryId":"ff9e217b-6721-4fc4-80d3-6d2f5e686e1f","queryName":"IO_Project_DataDestination"},"IO_Project_WriteToDataDestination":{"queryId":"87241e78-13a4-4592-8bc8-d9895441ec09","queryName":"IO_Project_WriteToDataDestination"},"IO_Project_TransformForWriteToDataDestination":{"queryId":"20b29907-dcd4-4285-9976-cbe46cf16a85","queryName":"IO_Project_TransformForWriteToDataDestination"},"DefaultStaging":{"queryId":"4361d965-db51-493c-9786-47d99fa71fbd","queryName":"DefaultStaging"},"FastCopyStaging":{"queryId":"4e4c7c32-a52f-4c96-904e-cbd150dd8607","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared DefaultDestination = let\r\n  DefaultDestination = Lakehouse.Contents(null){[workspaceId = \"b3b5a554-b416-4ea7-8161-6f084114bbf6\"]}[Data]{[lakehouseId = \"452f5f1e-80a3-4cdd-87cd-19b6787c5f3d\"]}[Data]\r\nin\r\n  DefaultDestination;\r\nshared IO_Project = let\r\n  Source = SharePoint.Files(\"https://equfrjbr.sharepoint.com/sites/Teste_ingest\", [ApiVersion = 15]),\r\n  #\"Filtered rows\" = Table.SelectRows(Source, each Text.Contains([Name], \"IO\")),\r\n  #\"Filtered hidden files\" = Table.SelectRows(#\"Filtered rows\", each [Attributes]?[Hidden]? <> true),\r\n  #\"Invoke custom function\" = Table.AddColumn(#\"Filtered hidden files\", \"Transform file\", each #\"Transform file\"([Content])),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Invoke custom function\", {{\"Name\", \"Source.Name\"}}),\r\n  #\"Removed other columns\" = Table.SelectColumns(#\"Renamed columns\", {\"Source.Name\", \"Transform file\"}),\r\n  #\"Expanded table column\" = Table.ExpandTableColumn(#\"Removed other columns\", \"Transform file\", Table.ColumnNames(#\"Transform file\"(#\"Sample file\"))),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Expanded table column\", {{\"IO\", Int64.Type}, {\"SAP Internal Number\", Int64.Type}, {\"Project\", type text}}),\r\n  #\"Renamed columns 1\" = Table.RenameColumns(#\"Changed column type\", {{\"Source.Name\", \"Source_Name\"}})\r\nin\r\n  #\"Renamed columns 1\";\r\nshared #\"Sample file\" = let\r\n  Source = SharePoint.Files(\"https://equfrjbr.sharepoint.com/sites/Teste_ingest\", [ApiVersion = 15]),\r\n  #\"Filtered rows\" = Table.SelectRows(Source, each Text.Contains([Name], \"IO\")),\r\n  #\"Filtered hidden files\" = Table.SelectRows(#\"Filtered rows\", each [Attributes]?[Hidden]? <> true),\r\n  Navigation = #\"Filtered hidden files\"{0}[Content]\r\nin\r\n  Navigation;\r\nshared Parameter = let\r\n  Parameter = #\"Sample file\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type binary, BinaryIdentifier = #\"Sample file\"]\r\nin\r\n  Parameter;\r\nshared #\"Transform Sample file\" = let\r\n  Source = Excel.Workbook(Parameter, null, true),\r\n  Navigation = Source{[Item = \"Planilha1\", Kind = \"Sheet\"]}[Data],\r\n  #\"Promoted headers\" = Table.PromoteHeaders(Navigation, [PromoteAllScalars = true])\r\nin\r\n  #\"Promoted headers\";\r\n[FunctionQueryBinding = \"{\"\"exemplarFormulaName\"\":\"\"Transform Sample file\"\"}\"]\r\nshared #\"Transform file\" = let\r\n  #\"Transform file\" = (Parameter as binary) => let\r\n  Source = Excel.Workbook(Parameter, null, true),\r\n  Navigation = Source{[Item = \"Planilha1\", Kind = \"Sheet\"]}[Data],\r\n  #\"Promoted headers\" = Table.PromoteHeaders(Navigation, [PromoteAllScalars = true])\r\nin\r\n  #\"Promoted headers\"\r\nin\r\n  #\"Transform file\";\r\nshared IO_Project_DataDestination = let\r\n  Target = DefaultDestination,\r\n  TableNavigation = Target{[ItemKind = \"Table\", Id = \"IO_Project\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[Source_Name = nullable Text.Type, IO = nullable Int64.Type, #\"SAP Internal Number\" = nullable Int64.Type, Project = nullable Text.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"FastCopyStaging\"]\r\nshared IO_Project_WriteToDataDestination = let\r\n  IO_Project_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = IO_Project_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], IO_Project_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  IO_Project_WriteToDataDestination;\r\nshared IO_Project_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(IO_Project, {\"Source_Name\", \"IO\", \"SAP Internal Number\", \"Project\"})\r\nin\r\n    SourceTable;\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null},{"path":"https://equfrjbr.sharepoint.com/sites/Teste_ingest","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://equfrjbr.sharepoint.com/sites/Teste_ingest\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"Id\":\"a35bd78c-ad74-4237-ab30-302dccd5a186\",\"Name\":\"Transform file from IO_Project\",\"Description\":null,\"ParentId\":null,\"Order\":0},{\"Id\":\"cdbf1978-36dc-4cae-acdb-6b12457e0e86\",\"Name\":\"Helper queries\",\"Description\":null,\"ParentId\":\"a35bd78c-ad74-4237-ab30-302dccd5a186\",\"Order\":0}]"}]}