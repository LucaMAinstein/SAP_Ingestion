{"name":"sharepoint_ingest_Zone3","ppdf:dataflowId":"41ae5f09-6a87-4777-a2cf-ba2bc79b3e0c","ppdf:owner":{"tenantId":"4de83c79-9810-417a-91e1-40913a869787","userId":"c072c24c-163e-472f-a8de-a41a06a627f4"},"ppdf:fastCopy":true,"version":"1.0","culture":"en-US","modifiedTime":"2025-04-16T01:56:00.5445601+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"DefaultDestination":{"queryId":"122cd9b0-78e9-4426-b8ee-0e6cc8e4573b","queryName":"DefaultDestination"},"Zone3_raw":{"queryId":"e565a321-0c21-4ae5-ac41-c8f73913a133","queryName":"Zone3_raw"},"Sample file":{"queryId":"555fd81a-a9ae-45a1-a974-8bed77d23372","queryName":"Sample file","queryGroupId":"8fd2104c-127e-41c0-933e-8b00f4f92b1b"},"Parameter":{"queryId":"ca0ca5ba-1ba8-4b36-a641-888238decaf3","queryName":"Parameter","queryGroupId":"8fd2104c-127e-41c0-933e-8b00f4f92b1b"},"Transform Sample file":{"queryId":"f4affaad-9d3c-4662-9842-e076a09d3659","queryName":"Transform Sample file","queryGroupId":"7226d583-5725-4fd4-ad4d-4ff6208659a6"},"Transform file":{"queryId":"f15f0764-e71f-47fe-992e-85e08a67caa2","queryName":"Transform file","queryGroupId":"8fd2104c-127e-41c0-933e-8b00f4f92b1b"},"Zone3_raw_DataDestination":{"queryId":"183251d6-25d6-4577-8994-172d4c89f4bb","queryName":"Zone3_raw_DataDestination"},"Zone3_raw_WriteToDataDestination":{"queryId":"0b21a472-2297-423b-8815-51f5de297f41","queryName":"Zone3_raw_WriteToDataDestination"},"Zone3_raw_TransformForWriteToDataDestination":{"queryId":"dd50d9fd-ef22-43cb-82b6-618019bf8e44","queryName":"Zone3_raw_TransformForWriteToDataDestination"},"DefaultStaging":{"queryId":"ce482cf1-f7e8-449d-879c-64078553a58e","queryName":"DefaultStaging"},"FastCopyStaging":{"queryId":"4dfc0272-3e27-45ae-97d2-4fbee4d440d5","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared DefaultDestination = let\r\n  DefaultDestination = Lakehouse.Contents(null){[workspaceId = \"b3b5a554-b416-4ea7-8161-6f084114bbf6\"]}[Data]{[lakehouseId = \"452f5f1e-80a3-4cdd-87cd-19b6787c5f3d\"]}[Data]\r\nin\r\n  DefaultDestination;\r\nshared Zone3_raw = let\r\n  Source = SharePoint.Files(\"https://equfrjbr.sharepoint.com/sites/Teste_ingest\", [ApiVersion = 15]),\r\n  #\"Filtered rows\" = Table.SelectRows(Source, each Text.Contains([Name], \"Zone3\")),\r\n  #\"Filtered hidden files\" = Table.SelectRows(#\"Filtered rows\", each [Attributes]?[Hidden]? <> true),\r\n  #\"Invoke custom function\" = Table.AddColumn(#\"Filtered hidden files\", \"Transform file\", each #\"Transform file\"([Content])),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Invoke custom function\", {{\"Name\", \"Source.Name\"}}),\r\n  #\"Removed other columns\" = Table.SelectColumns(#\"Renamed columns\", {\"Source.Name\", \"Transform file\"}),\r\n  #\"Expanded table column\" = Table.ExpandTableColumn(#\"Removed other columns\", \"Transform file\", Table.ColumnNames(#\"Transform file\"(#\"Sample file\"))),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Expanded table column\", {{\"Code1\", Int64.Type}, {\"SAP Internal Number1\", Int64.Type}, {\"Column1\", type text}, {\"Columns 2\", type text}, {\"Col3\", type text}, {\"Col 3\", type text}, {\"Project11\", type text}, {\"col 4\", type text}, {\"SAP Source11\", type text}, {\"Currency11\", type text}, {\"Budget (LC)11\", Int64.Type}, {\"Year11\", Int64.Type}, {\"Actual (LC)11\", Int64.Type}, {\"Commitment (LC)11\", Int64.Type}}),\r\n  #\"Choose columns\" = Table.SelectColumns(#\"Changed column type\", {\"Source.Name\", \"Code1\", \"SAP Internal Number1\", \"Project11\", \"SAP Source11\", \"Currency11\", \"Budget (LC)11\", \"Year11\", \"Actual (LC)11\", \"Commitment (LC)11\"}),\r\n  #\"Renamed columns 1\" = Table.RenameColumns(#\"Choose columns\", {{\"Source.Name\", \"Source_Name\"}})\r\nin\r\n  #\"Renamed columns 1\";\r\nshared #\"Sample file\" = let\r\n  Source = SharePoint.Files(\"https://equfrjbr.sharepoint.com/sites/Teste_ingest\", [ApiVersion = 15]),\r\n  #\"Filtered rows\" = Table.SelectRows(Source, each Text.Contains([Name], \"Zone3\")),\r\n  #\"Filtered hidden files\" = Table.SelectRows(#\"Filtered rows\", each [Attributes]?[Hidden]? <> true),\r\n  Navigation = #\"Filtered hidden files\"{0}[Content]\r\nin\r\n  Navigation;\r\nshared Parameter = let\r\n  Parameter = #\"Sample file\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type binary, BinaryIdentifier = #\"Sample file\"]\r\nin\r\n  Parameter;\r\nshared #\"Transform Sample file\" = let\r\n  Source = Excel.Workbook(Parameter, null, true),\r\n  Navigation = Source{[Item = \"Page 1\", Kind = \"Sheet\"]}[Data],\r\n  #\"Promoted headers\" = Table.PromoteHeaders(Navigation, [PromoteAllScalars = true])\r\nin\r\n  #\"Promoted headers\";\r\n[FunctionQueryBinding = \"{\"\"exemplarFormulaName\"\":\"\"Transform Sample file\"\"}\"]\r\nshared #\"Transform file\" = let\r\n  #\"Transform file\" = (Parameter as binary) => let\r\n  Source = Excel.Workbook(Parameter, null, true),\r\n  Navigation = Source{[Item = \"Page 1\", Kind = \"Sheet\"]}[Data],\r\n  #\"Promoted headers\" = Table.PromoteHeaders(Navigation, [PromoteAllScalars = true])\r\nin\r\n  #\"Promoted headers\"\r\nin\r\n  #\"Transform file\";\r\nshared Zone3_raw_DataDestination = let\r\n  Target = DefaultDestination,\r\n  TableNavigation = Target{[ItemKind = \"Table\", Id = \"Zone3_raw\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[Source_Name = nullable Text.Type, Code1 = nullable Int64.Type, #\"SAP Internal Number1\" = nullable Int64.Type, Project11 = nullable Text.Type, #\"SAP Source11\" = nullable Text.Type, Currency11 = nullable Text.Type, #\"Budget _LC_11\" = nullable Int64.Type, Year11 = nullable Int64.Type, #\"Actual _LC_11\" = nullable Int64.Type, #\"Commitment _LC_11\" = nullable Int64.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"FastCopyStaging\"]\r\nshared Zone3_raw_WriteToDataDestination = let\r\n  Zone3_raw_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = Zone3_raw_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], Zone3_raw_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  Zone3_raw_WriteToDataDestination;\r\nshared Zone3_raw_TransformForWriteToDataDestination = let\r\n    ColumnMappings = {[SourceColumnName = \"Source_Name\", DestinationColumnName = \"Source_Name\"], [SourceColumnName = \"Code1\", DestinationColumnName = \"Code1\"], [SourceColumnName = \"SAP Internal Number1\", DestinationColumnName = \"SAP Internal Number1\"], [SourceColumnName = \"Project11\", DestinationColumnName = \"Project11\"], [SourceColumnName = \"SAP Source11\", DestinationColumnName = \"SAP Source11\"], [SourceColumnName = \"Currency11\", DestinationColumnName = \"Currency11\"], [SourceColumnName = \"Budget (LC)11\", DestinationColumnName = \"Budget _LC_11\"], [SourceColumnName = \"Year11\", DestinationColumnName = \"Year11\"], [SourceColumnName = \"Actual (LC)11\", DestinationColumnName = \"Actual _LC_11\"], [SourceColumnName = \"Commitment (LC)11\", DestinationColumnName = \"Commitment _LC_11\"]},\r\n    SourceColumns = Table.SelectColumns(Zone3_raw, List.Transform(ColumnMappings, each _[SourceColumnName])),\r\n    TargetColumns = Table.RenameColumns(SourceColumns, List.Transform(ColumnMappings, each {_[SourceColumnName], _[DestinationColumnName]}))\r\nin\r\n    TargetColumns;\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null},{"path":"https://equfrjbr.sharepoint.com/sites/Teste_ingest","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://equfrjbr.sharepoint.com/sites/Teste_ingest\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"Id\":\"7226d583-5725-4fd4-ad4d-4ff6208659a6\",\"Name\":\"Transform file from Query\",\"Description\":null,\"ParentId\":null,\"Order\":0},{\"Id\":\"8fd2104c-127e-41c0-933e-8b00f4f92b1b\",\"Name\":\"Helper queries\",\"Description\":null,\"ParentId\":\"7226d583-5725-4fd4-ad4d-4ff6208659a6\",\"Order\":0}]"}]}